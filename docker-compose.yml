services:
  padel-server:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - CARGO_BUILD_FLAGS=${CARGO_BUILD_FLAGS:-}
    image: viva-padel-server:latest
    container_name: viva-padel-server
    ports:
      - "3000:3000"
    env_file:
      - ${DATA_PATH:-./server}/.env
    volumes:
      # Mount database for persistent data
      - ${DATA_PATH:-./server/data}:/usr/local/share/viva-padel-server/data
      # Mount mock data for testing
      - ./crates/testcases/data:/usr/local/share/viva-padel-server/mock-data
    environment:
      - DATABASE_URL=sqlite:///usr/local/share/viva-padel-server/data/viva_padel.db
      - PADEL_MOCK_DATA=/usr/local/share/viva-padel-server/mock-data
    restart: always
